# H·ªá**   | B√πi Th·ªã Thanh V√¢n                              |
| **Tr∆∞·ªùng**    | ƒê·∫°i h·ªçc Giao th√¥ng V Th·ªëng Ch·ªëng Gi·∫£ M·∫°o Khu√¥n M·∫∑t S·ª≠ D·ª•ng M√¥ H√¨nh Khu·∫øch T√°n v√† Vision Transformer

## 1. Gi·ªõi Thi·ªáu D·ª± √Ån

ƒê√¢y l√† kho m√£ ngu·ªìn cho d·ª± √°n nghi√™n c·ª©u v√† tri·ªÉn khai·∫≠n t·∫£i Th√†nh ph·ªë H·ªì Ch√≠ Minh |
| **Email**     | `thanh.van19062 m·ªôt h·ªá th·ªëng **Ch·ªëng Gi·∫£ m·∫°o Khu√¥n m·∫∑t (Face Anti-Spoofing - FAS)** ti√™n004@gmail.com`                  |
| **Th·ªùi gian** | Th√°ng 09, 2025                                 |

---

## 2. M√¥i Tr∆∞·ªùng v√† H·∫° T·∫ßng Th·ª±c Nghi·ªám

Do y√™u c·∫ßu t√≠nh ti·∫øn. M·ª•c ti√™u ch√≠nh c·ªßa d·ª± √°n l√† x√¢y d·ª±ng m·ªôt m√¥ h√¨nh m·∫°nh m·∫Ω, c√≥ kh·∫£ nƒÉng ph√¢n bi·ªát gi·ªØa c√°c h√¨nh to√°n c·ª±c l·ªõn c·ªßa c√°c m√¥ h√¨nh Diffusion v√† Transformer, to√†n b·ªô qu√° tr√¨nh th·ª±c nghi·ªám c·ªßa d·ª± √°n ƒë∆∞·ª£c th·ª±c hi·ªán tr√™n m·ªôt h·ªá ·∫£nh khu√¥n m·∫∑t th·∫≠t (live) v√† c√°c h√¨nh th·ª©c t·∫•n c√¥ng gi·∫£ m·∫°o ƒëa d·∫°ng, bao g·ªìm ·∫£nh in, ph√°t l·∫°i tr√™n m√†n h√¨nh, v√† m·∫∑t n·∫° 3D.

D·ª± √°n n√†y tri·ªÉn khai m·ªôt ki·∫øn tr√∫c hai th·ªëng m√°y ch·ªß chuy√™n d·ª•ng thu√™ ngo√†i v·ªõi c·∫•u h√¨nh chi ti·∫øt nh∆∞ sau:

| Th√†nh Ph·∫ßn | Chi Ti·∫øt K giai ƒëo·∫°n ph·ª©c t·∫°p, l·∫•y c·∫£m h·ª©ng t·ª´ ph∆∞∆°ng ph√°p lu·∫≠n **AG-FAS**, nh∆∞ng ƒë∆∞·ª£c c·∫£i ti·∫øn b·∫±ng c√°ch s·ª≠·ªπ Thu·∫≠t |
| :--- | :--- |
| **GPU** | 2 x NVIDIA GeForce RTX d·ª•ng **Vision Transformer (ViT)** l√†m backbone ch√≠nh, k·∫øt h·ª£p v·ªõi c∆° ch·∫ø **Cross-Attention** ƒë·ªÉ tƒÉng c∆∞·ªùng kh·∫£ 4090 (24GB VRAM m·ªói card) |
| **H·ªá ƒëi·ªÅu h√†nh** | Linux (Ubuntu/Debian-based) |
| **CUDA Version** | 12.x |
| ** nƒÉng ph√¢n t√≠ch v√† nh·∫≠n di·ªán.

| Th√¥ng Tin      | Chi Ti·∫øt                                       |
| -------------- | ---------------------------------------------- |
| **T√°c gi·∫£**    | B√πi Th·ªã Thanh V√¢n                              |
| **Tr∆∞·ªùng**      Ng√¥n ng·ªØ** | Python 3.10 |
| **Frameworks** | PyTorch, Hugging Face Transformers, Diffusers |

---

## 3. Ph√¢n T√≠ch D·ªØ Li·ªáu v√† Quy Tr√¨nh Ti·ªÅn X·ª≠ L√Ω| ƒê·∫°i h·ªçc Giao th√¥ng V·∫≠n t·∫£i Th√†nh ph·ªë H·ªì Ch√≠ Minh |
| **Email**      | `thanh.van

### 3.1. Ngu·ªìn D·ªØ Li·ªáu G·ªëc

D·ª± √°n s·ª≠ d·ª•ng m·ªôt b·ªô d·ªØ li·ªáu l·ªõn19062004@gmail.com`                  |
| **Th·ªùi gian** | Th√°ng 09, 2025                                 |

---

## 2. M√¥i Tr∆∞·ªùng Th·ª±c Nghi·ªám

 v√† ƒëa d·∫°ng, ƒë∆∞·ª£c t·ªïng h·ª£p t·ª´ hai ngu·ªìn ch√≠nh:
-   **FFHQ (Flickr-Faces-HQDo y√™u c·∫ßu t√≠nh to√°n c·ª±c k·ª≥ cao c·ªßa c√°c m√¥ h√¨nh Diffusion v√† Transformer, to√†n b·ªô qu√° tr√¨nh th·ª±c nghi·ªám, t·ª´):** Cung c·∫•p m·ªôt l∆∞·ª£ng l·ªõn ·∫£nh khu√¥n m·∫∑t th·∫≠t ch·∫•t l∆∞·ª£ng cao.
-   **CelebA- hu·∫•n luy·ªán ƒë·∫øn x·ª≠ l√Ω d·ªØ li·ªáu, ƒë∆∞·ª£c th·ª±c hi·ªán tr√™n m·ªôt h·ªá th·ªëng m√°y ch·ªß chuy√™n d·ª•ng thu√™ ngo√†i.

| Th√†nhSpoof:** M·ªôt b·ªô d·ªØ li·ªáu ti√™u chu·∫©n trong lƒ©nh v·ª±c FAS, cung c·∫•p c·∫£ ·∫£nh th·∫≠t v√† 10 lo·∫°i t·∫•n Ph·∫ßn | Chi Ti·∫øt K·ªπ Thu·∫≠t |
| :--- | :--- |
| **GPU** |  c√¥ng gi·∫£ m·∫°o kh√°c nhau.

| Ngu·ªìn D·ªØ Li·ªáu | Lo·∫°i | S·ªë L∆∞·ª£ng ·∫¢nh G·ªëc |
|2 x NVIDIA GeForce RTX 4090 (24GB VRAM m·ªói card) |
| **CPU** | :--- | :--- | :--- |
| FFHQ | Live | 2,562 |
| Cele (Th√¥ng tin CPU c·ªßa m√°y ch·ªß) |
| **RAM** | (Th√¥ng tin RAM c·ªßa m√°y ch·ªß) |
| **H·ªá ƒëi·ªÅu h√†nh** | Ubuntu 22.04 LTS (Linux) |
| **N·ªÅn t·∫£ng** | Python 3.10, PyTorch 1.12+ (CUDA 11bA | Live | 35,000 |
| CelebA | Spoof | 3.6+) |
| **Th∆∞ vi·ªán ch√≠nh** | `transformers`, `diffusers`, `opencv-python`, `sc3,433 |
| **T·ªïng c·ªông** | | **70,995** |

### ikit-learn`, `pandas` |

---

## 3. D·ªØ Li·ªáu v√† Quy Tr√¨nh Ti3.2. Quy Tr√¨nh Ti·ªÅn X·ª≠ L√Ω
T·∫•t c·∫£ ·∫£nh ƒë·∫ßu v√†o ƒë·ªÅu tr·∫£i qua m·ªôt pipeline ti·ªÅn x·ª≠ l√Ω chu·∫©n h√≥a ƒë·ªÉ lo·∫°i b·ªè c√°c bi·∫øn thi√™n kh√¥ng mong mu·ªën v√† ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n:
1.  ·ªÅn X·ª≠ L√Ω

### 3.1. Ngu·ªìn D·ªØ Li·ªáu G·ªëc

D·ª± √°n s·ª≠ d·ª•ng k·∫øt h·ª£p hai b·ªô d·ªØ li·ªáu l·ªõn v√† ch·∫•t l∆∞·ª£ng cao:
-   **FFHQ (Flickr-Faces-HQ):**Ph√°t hi·ªán v√† CƒÉn ch·ªânh:** S·ª≠ d·ª•ng m√¥ h√¨nh MTCNN ƒë·ªÉ ph√°t hi·ªán khu√¥n m·∫∑t v√† c√°c ƒëi·ªÉm m·ªëc (landmarks).
2.  **C·∫Øt (Cropping):** C·∫Øt ·∫£nh ƒë·ªÉ ch·ªâ gi·ªØ l·∫°i v√πng m·∫∑t, lo·∫°i b·ªè ph·∫ßn l·ªõn n·ªÅn c√≥ th·ªÉ g√¢y nhi·ªÖu.
3.  **Thay ƒë·ªïi k√≠ch th∆∞·ªõc (** Cung c·∫•p m·ªôt l∆∞·ª£ng l·ªõn ·∫£nh khu√¥n m·∫∑t th·∫≠t, ƒëa d·∫°ng, ch·∫•t l∆∞·ª£ng cao, ch·ªß y·∫øu d√πng ƒë·ªÉ hu·∫•nResizing):** Resize t·∫•t c·∫£ c√°c ·∫£nh v·ªÅ k√≠ch th∆∞·ªõc `224x224` pixels ƒë·ªÉ ph√π luy·ªán m√¥ h√¨nh DFG.
-   **CelebA-Spoof:** M·ªôt b·ªô d·ªØ li·ªáu ti√™u chu·∫©n cho b√†i h·ª£p v·ªõi ƒë·∫ßu v√†o c·ªßa m√¥ h√¨nh ViT.
4.  **Chu·∫©n h√≥a (Normalization):** Chuy·ªÉn gi√° to√°n FAS, cung c·∫•p c·∫£ ·∫£nh th·∫≠t v√† 10 lo·∫°i t·∫•n c√¥ng gi·∫£ m·∫°o kh√°c nhau, ƒë∆∞·ª£c g√°n nh tr·ªã pixel v·ªÅ kho·∫£ng `[-1, 1]`.

### 3.3. Ph√¢n Chia D·ªØ Li·ªáu√£n chi ti·∫øt.

### 3.2. Ti·ªÅn X·ª≠ L√Ω

T·∫•t c·∫£ ·∫£nh ƒë·∫ßu v√†o (c
ƒê·ªÉ ƒë·∫£m b·∫£o t√≠nh kh√°ch quan c·ªßa k·∫øt qu·∫£ ƒë√°nh gi√°, d·ªØ li·ªáu ƒë∆∞·ª£c chia theo ph∆∞∆°ng ph√°p **ph√¢n chia theo ƒë·ªãnh danh (subject-disjoint)**. T·ª©c l√†, m·ªôt ng∆∞·ªùi (subject) ƒë√£ xu·∫•t hi·ªán trong t·∫≠p hu·∫•n luy·ªán s·∫Ω·∫£ live v√† spoof) ƒë·ªÅu tr·∫£i qua m·ªôt pipeline ti·ªÅn x·ª≠ l√Ω ƒë·ªìng b·ªô ƒë·ªÉ lo·∫°i b·ªè c√°c bi·∫øn thi√™n kh√¥ng mong mu·ªën v√† chu·∫©n h√≥a d·ªØ li·ªáu:
1.  **Ph√°t hi·ªán v√† CƒÉn ch·ªânh:** S·ª≠ d·ª•ng m√¥ h√¨nh MTCNN ƒë·ªÉ kh√¥ng bao gi·ªù xu·∫•t hi·ªán trong t·∫≠p ki·ªÉm ƒë·ªãnh ho·∫∑c ki·ªÉm tra. T·ª∑ l·ªá ph√¢n chia cu·ªëi c√πng l√† **80% Training, 10% Validation, v√† 10% Test**.

---

## 4. Ph∆∞∆°ng Ph√°p t·ª± ƒë·ªông ph√°t hi·ªán khu√¥n m·∫∑t v√† c√°c ƒëi·ªÉm m·ªëc (landmarks).
2.  **C·∫Øt (Cropping):** C Lu·∫≠n Chi Ti·∫øt V·ªÅ M√¥ H√¨nh

### 4.1. T·ªïng quan ki·∫øn tr√∫c
H·ªá th·ªëng bao·∫Øt ·∫£nh ƒë·ªÉ ch·ªâ gi·ªØ l·∫°i v√πng m·∫∑t, lo·∫°i b·ªè ph·∫ßn l·ªõn n·ªÅn c√≥ th·ªÉ g√¢y nhi·ªÖu.
3.  **Thay g·ªìm hai m√¥ h√¨nh ho·∫°t ƒë·ªông tu·∫ßn t·ª±. DFG ƒë√≥ng vai tr√≤ l√† m·ªôt "b·ªô ti·ªÅn x·ª≠ l√Ω th√¥ng minh", bi·∫øn ƒë·ªïi K√≠ch th∆∞·ªõc (Resize):** Chu·∫©n h√≥a t·∫•t c·∫£ c√°c khu√¥n m·∫∑t v·ªÅ c√πng m·ªôt k√≠ch th∆∞·ªõc (v√≠ d·ª•: 224x224) ƒë·ªÉ ph√π h·ª£p v·ªõi ƒë·∫ßu v√†o c·ªßa m√¥ h√¨nh.
4.  **Chu·∫©n ƒë·ªïi ·∫£nh ƒë·∫ßu v√†o th√†nh m·ªôt d·∫°ng "b·∫±ng ch·ª©ng" d·ªÖ ph√¢n t√≠ch h∆°n. OA-Net sau ƒë√≥ s·∫Ω ph√¢n t√≠ch b·∫±ng h√≥a (Normalization):** Chuy·ªÉn gi√° tr·ªã pixel v·ªÅ m·ªôt kho·∫£ng nh·∫•t ƒë·ªãnh, l√† y√™u c·∫ßu ti√™u chu·∫©n cho c√°c m·∫°ng ch·ª©ng n√†y ƒë·ªÉ ƒë∆∞a ra k·∫øt lu·∫≠n cu·ªëi c√πng.

`üñºÔ∏è ·∫¢nh G·ªëc ‚û°Ô∏è üß† DFG  neural.

### 3.3. Ph√¢n Chia D·ªØ Li·ªáu

ƒê·ªÉ ƒë·∫£m b·∫£o t√≠nh kh√°ch quan c·ªßa k·∫øt qu·∫£‚û°Ô∏è üî¨ T√≠n hi·ªáu B·∫•t th∆∞·ªùng (Anomalous Cue) ‚û°Ô∏è üïµÔ∏è‚Äç‚ôÄÔ∏è OA-Net , d·ªØ li·ªáu ƒë∆∞·ª£c ph√¢n chia theo nguy√™n t·∫Øc **t√°ch bi·ªát ƒë·ªãnh danh (subject-disjoint)**. C√°c ch·ªß‚û°Ô∏è ‚úÖ/‚ùå K·∫øt qu·∫£`

### 4.2. Giai ƒëo·∫°n 1: DFG (De th·ªÉ (ng∆∞·ªùi) xu·∫•t hi·ªán trong t·∫≠p hu·∫•n luy·ªán s·∫Ω kh√¥ng xu·∫•t hi·ªán trong t·∫≠p ki·ªÉm ƒë·ªãnh ho·∫∑c t·∫≠p ki·ªÉm tra. ƒêi·ªÅu n√†y ngƒÉn-fake Face Generator) - M√¥ h√¨nh Sinh T√≠n hi·ªáu B·∫•t th∆∞·ªùng

-   **M·ª•c ti√™u:** D ch·∫∑n hi·ªán t∆∞·ª£ng "h·ªçc v·∫πt" v√† ƒë√°nh gi√° ƒë√∫ng kh·∫£ nƒÉng t·ªïng qu√°t h√≥a c·ªßa m√¥ h√¨nh tr√™n nh·ªØng ng∆∞·ªùi ho√†nFG kh√¥ng h·ªçc v·ªÅ ·∫£nh gi·∫£ m·∫°o. N√≥ ƒë∆∞·ª£c hu·∫•n luy·ªán ch·ªâ tr√™n d·ªØ li·ªáu th·∫≠t ƒë·ªÉ h·ªçc m·ªôt c√°ch s√¢u s·∫Øc v·ªÅ s·ª± to√†n m·ªõi.

---

## 4. Ki·∫øn Tr√∫c M√¥ H√¨nh v√† Ph∆∞∆°ng Ph√°p Lu·∫≠n Chi Ti·∫øt

H ph√¢n ph·ªëi c·ªßa m·ªôt "khu√¥n m·∫∑t th·∫≠t".
-   **Ki·∫øn tr√∫c:**
    -   **·ªá th·ªëng ƒë∆∞·ª£c x√¢y d·ª±ng d·ª±a tr√™n m·ªôt pipeline hai giai ƒëo·∫°n.

**Lu·ªìng ho·∫°t ƒë·ªông t·ªïng th·ªÉ:**
VAE (Variational Autoencoder):** M√£ h√≥a ·∫£nh sang kh√¥ng gian ti·ªÅm ·∫©n (latent space) v√† gi·∫£i m√£ ng∆∞·ª£c`·∫¢nh G·ªëc ‚û°Ô∏è DFG ‚û°Ô∏è T√≠n hi·ªáu B·∫•t th∆∞·ªùng (Anomalous Cue) ‚û°Ô∏è OA l·∫°i.
    -   **UNet:** Ki·∫øn tr√∫c ch√≠nh c·ªßa m√¥ h√¨nh Diffusion, th·ª±c hi·ªán qu√° tr√¨nh kh·ª≠ nhi·ªÖu.-Net ‚û°Ô∏è K·∫øt qu·∫£`

### 4.1. Giai ƒëo·∫°n 1: DFG (De
    -   **Identity Encoder (ArcFace):** Tr√≠ch xu·∫•t vector ƒë·∫∑c tr∆∞ng nh·∫≠n d·∫°ng ƒë·ªÉ ƒë·∫£m b·∫£o ·∫£nh-fake Face Generator) - C·ªó M√°y T·∫°o B·∫±ng Ch·ª©ng

Giai ƒëo·∫°n ƒë·∫ßu ti√™n s·ª≠ d·ª•ng m·ªôt **M t√°i t·∫°o v·∫´n gi·ªØ l·∫°i danh t√≠nh c·ªßa ng∆∞·ªùi trong ·∫£nh g·ªëc.
-   **Qu√° tr√¨nh ho·∫°t ƒë·ªông:**
    1.√¥ h√¨nh Khu·∫øch t√°n (Diffusion Model - DFG)**.
-   **M·ª•c ti√™u:** DFG ƒë∆∞·ª£c  ·∫¢nh g·ªëc ƒë∆∞·ª£c m√£ h√≥a th√†nh vector ti·ªÅm ·∫©n `z`.
    2.  Nhi·ªÖu ƒë∆∞·ª£c th√™m v√†o `z` ƒë·ªÉ t·∫°o ra `z_t`.
    3.  UNet, v·ªõi ƒëi·ªÅu ki·ªán l√† vector nh·∫≠n d·∫°ng t·ª´ hu·∫•n luy·ªán **ch·ªâ tr√™n d·ªØ li·ªáu khu√¥n m·∫∑t th·∫≠t**. Nhi·ªám v·ª• c·ªßa n√≥ kh√¥ng ph·∫£i l√† ph√¢n lo·∫°i, m√† l√† h·ªçc ArcFace, s·∫Ω kh·ª≠ nhi·ªÖu `z_t` qua nhi·ªÅu b∆∞·ªõc ƒë·ªÉ t√°i t·∫°o l·∫°i vector ti·ªÅm ·∫©n " m·ªôt c√°ch s√¢u s·∫Øc v·ªÅ s·ª± ph√¢n ph·ªëi c·ªßa m·ªôt "khu√¥n m·∫∑t th·∫≠t".
-   **Th√†nh ph·∫ßn:**s·∫°ch" `z'`.
    4.  VAE gi·∫£i m√£ `z'` ƒë·ªÉ t·∫°o ra ·∫£nh t√°i t·∫°o.
     DFG bao g·ªìm m·ªôt UNet, m·ªôt VAE, v√† m·ªôt Identity Encoder (ArcFace) ƒë·ªÉ b·∫£o to√†n ƒë·∫∑c t√≠nh nh·∫≠n d·∫°ng trong qu√° tr√¨nh t√°i t·∫°o.
-   **C∆° ch·∫ø ho·∫°t ƒë·ªông:** Khi nh·∫≠n m·ªôt ·∫£nh ƒë·∫ßu5.  **T√≠n hi·ªáu B·∫•t th∆∞·ªùng** ƒë∆∞·ª£c t√≠nh b·∫±ng `abs(·∫¢nh G·ªëc - ·∫¢nh T√°i T·∫°o)`.

### 4.3. Giai ƒëo·∫°n 2: OA-Net (Off-real Attention Network) - M√¥ v√†o, DFG s·∫Ω c·ªë g·∫Øng t√°i t·∫°o l·∫°i m·ªôt phi√™n b·∫£n "l√Ω t∆∞·ªüng" v√† "th·∫≠t" c·ªßa ·∫£nh ƒë√≥. **"T√≠n hi·ªáu B·∫•t th∆∞·ªùng" (Anomalous Cue)** ƒë∆∞·ª£c t√≠nh b·∫±ng hi·ªáu s·ªë tuy·ªát ƒë·ªëi H√¨nh Ph√¢n T√≠ch Chuy√™n S√¢u

-   **M·ª•c ti√™u:** ƒê√¢y l√† "b·ªô n√£o" gi·ªØa ·∫£nh g·ªëc v√† ·∫£nh ƒë∆∞·ª£c t√°i t·∫°o.

**V√≠ d·ª• Tr·ª±c quan v·ªÅ Ho·∫°t ƒë·ªông c·ªßa DFG:**

 ch√≠nh, ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ ph√¢n t√≠ch c√°c t√≠n hi·ªáu b·∫•t th∆∞·ªùng do DFG cung c·∫•p.
-   **Ki·∫øn tr√∫c chiB·∫£ng d∆∞·ªõi ƒë√¢y minh h·ªça c√°ch DFG x·ª≠ l√Ω hai tr∆∞·ªùng h·ª£p th·ª±c t·∫ø: m·ªôt ·∫£nh th·∫≠t ·ªü t∆∞ th·∫ø kh√≥ (out-of-distribution) v√† m·ªôt ·∫£nh gi·∫£ m·∫°o.

| Lo·∫°i | ·∫¢nh G·ªëc | ·∫¢nh T√°i T·∫°o ti·∫øt:**

| Th√†nh Ph·∫ßn | Ki·∫øn Tr√∫c S·ª≠ D·ª•ng | M·ª•c ƒê√≠ch & Ho·∫°t ƒê·ªông |
| :--- | :--- | :--- |
| **ƒê·∫ßu v√†o** | T√≠n hi·ªáu B·∫•t th∆∞·ªùng | D·ªØ li·ªáu ƒë·∫ßu v√†o cho c·∫£ hai lu·ªìng x·ª≠ l√Ω c·ªßa OA-Net. |
| **Encoder Ph·ª•** | **Res b·ªüi DFG | T√≠n hi·ªáu B·∫•t th∆∞·ªùng (Anomalous Cue) | Ph√¢n T√≠ch |
|Net-18** | Tr√≠ch xu·∫•t c√°c ƒë·∫∑c tr∆∞ng kh√¥ng gian (spatial features) c·ª•c b·ªô, chi ti·∫øt t·ª´ t√≠n hi·ªáu b·∫•t th∆∞·ªùng. ƒê·∫ßu ra ƒë∆∞·ª£c chi·∫øu (project) sang kh√¥ng gian 768 chi·ªÅu ƒë·ªÉ t∆∞∆°ng th√≠ch v·ªõi ViT :--- | :---: | :---: | :---: | :--- |
| **TH·∫¨T (Live. |
| **Backbone Ch√≠nh** | **Vision Transformer (ViT-Base)** | X·ª≠ l√Ω t√≠n)**<br>*(Ca kh√≥)* | ![Live Sample Original](results/readme_assets/live_sample_difficult hi·ªáu b·∫•t th∆∞·ªùng ƒë·ªÉ n·∫Øm b·∫Øt c√°c m·ªëi quan h·ªá v√† ng·ªØ c·∫£nh to√†n c·ª•c (global context) th√¥ng qua c∆° ch·∫ø self_case.png) | M√¥ h√¨nh th·∫•t b·∫°i trong vi·ªác t√°i t·∫°o ·∫£nh c√≥ t∆∞ th·∫ø l·∫°, c·ªë g·∫Øng "√©p-attention. |
| **C∆° ch·∫ø K·∫øt h·ª£p** | **12 L·ªõp Cross-Attention** |" n√≥ v·ªÅ m·ªôt d·∫°ng chu·∫©n. | K·∫øt qu·∫£ l√† m·ªôt cue r·∫•t s√°ng, c√≥ nguy c∆° b·ªã OA-Net nh·∫≠n nh·∫ßm l√† gi·∫£ m·∫°o. | *ƒêi·ªÅu n√†y cho th·∫•y gi·ªõi h·∫°n c·ªßa DFG v·ªõi d·ªØ li·ªáu ngo√†i ph√¢n ph·ªëi v√† l√† T·∫°i m·ªói l·ªõp trong s·ªë 12 l·ªõp c·ªßa ViT, ƒë·∫∑c tr∆∞ng t·ª´ ViT (ƒë√≥ng vai tr√≤ `query`) s·∫Ω nguy√™n nh√¢n ti·ªÅm t√†ng g√¢y ra l·ªói **BPCER** (nh·∫≠n nh·∫ßm ng∆∞·ªùi th·∫≠t).* |
| **GI "tham kh·∫£o" th√¥ng tin t·ª´ ƒë·∫∑c tr∆∞ng c·ªßa ResNet (ƒë√≥ng vai tr√≤ `key` v√† `value`). Qu·∫¢ M·∫†O (Spoof)**<br>*(Ca th√†nh c√¥ng)* | ![Spoof Sample Original](results/readme_assets/spoof_sample_detection_case.png) | DFG "s·ª≠a ch·ªØa" ·∫£nh gi·∫£ m·∫°o, t·∫°o√° tr√¨nh n√†y gi√∫p l√†m gi√†u th√¥ng tin cho lu·ªìng ViT. |
| **B·ªô Ph√¢n Lo·∫°i** | **Linear ra m·ªôt phi√™n b·∫£n khu√¥n m·∫∑t tr√¥ng "th·∫≠t" h∆°n. | S·ª± kh√°c bi·ªát l·ªõn t·∫°o ra m·ªôt cue r·∫•t s√°ng, Layer** | ƒê∆∞a ra quy·∫øt ƒë·ªãnh cu·ªëi c√πng (Real/Spoof) d·ª±a tr√™n ƒë·∫∑c tr∆∞ng t·ª´ token `[ l√†m n·ªïi b·∫≠t c√°c v√πng b·∫•t th∆∞·ªùng. | *ƒê√¢y l√† "b·∫±ng ch·ª©ng" r√µ r√†ng ƒë·ªÉ OA-Net h·ªçcCLS]` c·ªßa ViT sau khi ƒë√£ ƒë∆∞·ª£c tƒÉng c∆∞·ªùng th√¥ng tin. |

---

## 5. K·∫øt Qu v√† ph√°t hi·ªán t·∫•n c√¥ng, gi√∫p gi·∫£m l·ªói **APCER** (b·ªè l·ªçt t·∫•n c√¥ng gi·∫£ m·∫°o).* |

###·∫£ Th·ª±c Nghi·ªám v√† ƒê√°nh Gi√°

### 5.1. Qu√° tr√¨nh Hu·∫•n luy·ªán
M√¥ h√¨nh ƒë∆∞·ª£c hu·∫•n luy·ªán tr√™n h·ªá th·ªëng 2 GPU v·ªõi c√°c k·ªπ thu·∫≠t t·ªëi ∆∞u h√≥a `nn.DataParallel` v√† `torch.amp 4.2. Giai ƒëo·∫°n 2: OA-Net (Off-real Attention Network) - M√¥ H√¨nh Ph`. C∆° ch·∫ø **D·ª´ng S·ªõm (Early Stopping)** ƒë√£ ho·∫°t ƒë·ªông hi·ªáu qu·∫£, k·∫øt th√∫c qu√° tr√¨nh hu·∫•n luy·ªán sau √¢n T√≠ch Chuy√™n S√¢u

ƒê√¢y l√† "b·ªô n√£o" c·ªßa h·ªá th·ªëng, ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ ph√¢n t√≠ch c√°c t√≠n hi·ªáu b·∫•t th∆∞·ªùng do DFG cung c·∫•p.

| Th√†nh Ph·∫ßn | Ki·∫øn Tr√∫c S·ª≠ D·ª•ng | M·ª•c15 epochs. D·ª±a tr√™n loss c·ªßa t·∫≠p ki·ªÉm ƒë·ªãnh, m√¥ h√¨nh t·ªët nh·∫•t ƒë·∫°t ƒë∆∞·ª£c ·ªü **Epoch th·ª© 4**.

 ƒê√≠ch |
| :--- | :--- | :--- |
| **ƒê·∫ßu v√†o** | T√≠n hi·ªáu B·∫•t th∆∞·ªùng | D·ªØ li·ªáu ƒë·∫ßu v√†o duy nh·∫•t cho OA-Net, ch·ª©a ƒë·ª±ng c√°c "b·∫±ng ch·ª©ng" gi·∫£ m·∫°o. |
| **Encoder Ph·ª•** | **ResNet-18** | Tr√≠ch xu·∫•t c√°c![ƒê∆∞·ªùng cong Hu·∫•n luy·ªán v√† Ki·ªÉm ƒë·ªãnh](results/charts/1_training_curves.png)

### 5.2. ƒê√°nh Gi√° Hi·ªáu Su·∫•t Cu·ªëi C√πng

M√¥ h√¨nh t·ªët nh·∫•t ƒë∆∞·ª£c ƒë√°nh gi√° tr√™n t·∫≠p ƒë·∫∑c tr∆∞ng kh√¥ng gian (spatial features) c·ª•c b·ªô, chi ti·∫øt t·ª´ t√≠n hi·ªáu b·∫•t th∆∞·ªùng. |
| **Backbone Ch√≠nh** | **Vision Transformer (ViT-Base)** | X·ª≠ l√Ω t√≠n hi·ªáu b·∫•t th∆∞·ªùng ƒë·ªÉ n·∫Øm b·∫Øt ki·ªÉm tra (test set) v·ªõi 742 m·∫´u ch∆∞a t·ª´ng th·∫•y.

#### **Ma Tr·∫≠n Nh·∫ßm L c√°c m·ªëi quan h·ªá v√† ng·ªØ c·∫£nh to√†n c·ª•c (global context). |
| **C∆° ch·∫ø K·∫øt h·ª£p** | **12 L·ªõp Cross-Attention** | T·∫°i m·ªói l·ªõp c·ªßa ViT, m·ªôt module `OffRealAttention` cho ph√©p·∫´n (Confusion Matrix)**

![Heatmap Ma tr·∫≠n Nh·∫ßm l·∫´n](results/charts/6_confusion_matrix_ lu·ªìng ViT "tham kh·∫£o" th√¥ng tin t·ª´ lu·ªìng ResNet, gi√∫p m√¥ h√¨nh t·∫≠p trung v√†o c√°c v√πng "heatmap.png)

#### **B·∫£ng Ch·ªâ S·ªë Hi·ªáu Su·∫•t**

| Ch·ªâ S·ªë | Gi√° Tr·ªã | √ù nghƒ©a & T·∫ßm quan tr·ªçng |
| :--- | :--- | :--- |
| **Accuracy** | **b·∫±ng ch·ª©ng" quan tr·ªçng nh·∫•t. |
| **B·ªô Ph√¢n Lo·∫°i** | **Linear Layer** | ƒê84.10%** | T·ª∑ l·ªá d·ª± ƒëo√°n ƒë√∫ng tr√™n t·ªïng s·ªë m·∫´u. |
| **APCER** | **6.85%** | **(L·ªói An ninh)** T·ª∑ l·ªá t·∫•n c√¥ng gi·∫£ m·∫°o∆∞a ra quy·∫øt ƒë·ªãnh cu·ªëi c√πng (Real/Spoof) d·ª±a tr√™n ƒë·∫∑c tr∆∞ng t·ª´ token `[CLS]` c·ªßa ViT. |

---

## 5. Quy Tr√¨nh Hu·∫•n Luy·ªán v√† T·ªëi ∆Øu H√≥a b·ªã b·ªè l·ªçt (nh·∫≠n nh·∫ßm l√† th·∫≠t). **C√†ng th·∫•p c√†ng t·ªët.** |
| **BPCER**

-   **Pipeline:** ƒê·∫ßu ti√™n, m√¥ h√¨nh DFG ƒë∆∞·ª£c hu·∫•n luy·ªán tr√™n d·ªØ li·ªáu th·∫≠t. Sau ƒë√≥, D | **24.67%** | **(L·ªói Tr·∫£i nghi·ªám)** T·ª∑ l·ªá ng∆∞·ªùi d√πng th·∫≠t b·ªã t·ª´FG ƒë∆∞·ª£c d√πng ƒë·ªÉ sinh ra to√†n b·ªô t·∫≠p d·ªØ li·ªáu cues. Cu·ªëi c√πng, OA-Net ƒë∆∞·ª£c hu·∫•n luy·ªán tr√™n t·∫≠p ch·ªëi (nh·∫≠n nh·∫ßm l√† gi·∫£). **C√†ng th·∫•p c√†ng t·ªët.** |
| **ACER** | ** d·ªØ li·ªáu cues n√†y.
-   **T·ªëi ∆∞u h√≥a Hu·∫•n luy·ªán:** Do m√¥ h√¨nh r·∫•t l·ªõn, hai k·ªπ15.76%** | **(L·ªói Trung b√¨nh)** Th∆∞·ªõc ƒëo c√¢n b·∫±ng gi·ªØa APCER v√† BPC thu·∫≠t t·ªëi ∆∞u h√≥a hi·ªáu su·∫•t ƒë√£ ƒë∆∞·ª£c √°p d·ª•ng:
    1.  **Song song D·ªØ li·ªáu (`nn.DataParallelER, th·ªÉ hi·ªán hi·ªáu su·∫•t t·ªïng th·ªÉ. |

**Ph√¢n t√≠ch:** K·∫øt qu·∫£ cho th·∫•y m√¥ h√¨nh c√≥ kh·∫£ nƒÉng ph√°t`):** T·∫≠n d·ª•ng s·ª©c m·∫°nh c·ªßa c·∫£ hai GPU ƒë·ªÉ chia s·∫ª t·∫£i c√¥ng vi·ªác, gi√∫p gi·∫£m th·ªùi gian hu·∫•n hi·ªán t·∫•n c√¥ng gi·∫£ m·∫°o t·ªët (APCER th·∫•p). Tuy nhi√™n, ƒëi·ªÉm y·∫øu n·∫±m ·ªü t·ª∑ l·ªá nh·∫≠n nh·∫ßm luy·ªán m·ªói epoch.
    2.  **ƒê·ªô ch√≠nh x√°c H·ªón h·ª£p (`torch.cuda.amp ng∆∞·ªùi d√πng th·∫≠t (BPCER cao), ch·ªß y·∫øu do m√¥ h√¨nh DFG qu√° nh·∫°y c·∫£m v·ªõi c√°c ·∫£nh th·∫≠t c√≥`):** S·ª≠ d·ª•ng c√°c ph√©p to√°n 16-bit (FP16) ƒë·ªÉ tƒÉng t·ªëc ƒë·ªô x·ª≠ l√Ω v√† gi·∫£m ƒë√°ng k·ªÉ l∆∞·ª£ng VRAM s·ª≠ d·ª•ng.
-   **C∆° ch·∫ø ƒëi·ªÅu khi·ªÉn:** Qu√° tr√¨nh hu·∫•n luy·ªán s·ª≠ d·ª•ng scheduler ch·∫•t l∆∞·ª£ng th·∫•p ho·∫∑c g√≥c ch·ª•p l·∫°.

---

## 6. H∆∞·ªõng D·∫´n C√†i ƒê·∫∑t v√† S·ª≠ D·ª•ng

### 6.1. Y√™u C·∫ßu
- Python 3.8+
- PyTorch, Transformers `ReduceLROnPlateau` ƒë·ªÉ t·ª± ƒë·ªông gi·∫£m learning rate v√† c∆° ch·∫ø `Early Stopping` ƒë·ªÉ k·∫øt th√∫c s·ªõm khi m√¥ h√¨nh ng·ª´ng c·∫£i thi·ªán, tr√°nh l√£ng ph√≠ t√†i nguy√™n v√† overfitting.

---

## 6. K·∫øt, Diffusers
- OpenCV, Scikit-learn, Pandas, Matplotlib, Seaborn

### 6.2. C√†i ƒê·∫∑t
```bash
# Clone kho m√£ ngu·ªìn
git clone https://github.com/vanuji Qu·∫£ Th·ª±c Nghi·ªám

### 6.1. ƒê∆∞·ªùng Cong Hu·∫•n Luy·ªán (Training Curves)

Mash9/FAS_DFG-OANET_Project.git
cd FAS_DFG-OAN√¥ h√¨nh ƒë∆∞·ª£c hu·∫•n luy·ªán trong 15 epochs. D·ª±a tr√™n loss c·ªßa t·∫≠p ki·ªÉm ƒë·ªãnh (validation), m√¥ h√¨nh t·ªët nh·∫•t ƒë·∫°t ƒë∆∞·ª£c ·ªü **Epoch th·ª© 4**, tr∆∞·ªõc khi c√≥ d·∫•u hi·ªáu overfitting.

![ƒê∆∞·ªùng cong Hu·∫•n luy·ªán v√† Ki·ªÉm ƒë·ªãnh](results/charts/1_training_curves.png)

### 6.2. ƒê√°nh Gi√° Hi·ªáu Su·∫•t Cu·ªëi C√πng tr√™n T·∫≠p Test

B·∫£ng d∆∞·ªõi ƒë√¢y t·ªïng h·ª£p c√°c ch·ªâ s·ªë hi·ªáu su·∫•t cu·ªëi c√πng tr√™n t·∫≠p test.

| Ch·ªâ S·ªë | Gi√° Tr·ªã | √ù nghƒ©a & T·∫ßm quan tr·ªçng |
| :--- | :--- | :--- |
| **Accuracy** | **84.10%** | T·ª∑ l·ªá d·ª± ƒëo√°n ƒë√∫ng tr√™n t·ªïng s·ªë m·∫´u. |
| **APCER** | **6.85%** | **(L·ªói An ninh)** T·ª∑ l·ªá t·∫•n c√¥ng gi·∫£ m·∫°o b·ªã b·ªè l·ªçt (nh·∫≠n nh·∫ßm l√† th·∫≠t). **C√†ng th·∫•p c√†ng t·ªët.** |
| **BPCER** | **24.67%** |ET_Project

# C√†i ƒë·∫∑t c√°c th∆∞ vi·ªán c·∫ßn thi·∫øt
pip install -r requirements.txt
6.3. H∆∞·ªõng D·∫´n Ch·∫°y
D·ª± ƒêo√°n (Inference):
code
Bash
# Ch·∫°y ·ªü ch·∫ø ƒë·ªô t∆∞∆°ng t√°c (upload file v√†o th∆∞ m·ª•c /uploads)
python3 src/scripts/predict.py
T·∫°o B√°o C√°o:
code
Bash
# T√°i t·∫°o t·∫•t c·∫£ bi·ªÉu ƒë·ªì v√† b√°o c√°o t·ª´ c√°c model v√† log ƒë√£ c√≥
python3 src/scripts/generate_full_report.py
7. K·∫øt Lu·∫≠n v√† H∆∞·ªõng Ph√°t Tri·ªÉn T∆∞∆°ng Lai
D·ª± √°n ƒë√£ tri·ªÉn khai th√†nh c√¥ng m·ªôt h·ªá th·ªëng Ch·ªëng Gi·∫£ m·∫°o Khu (L·ªói Tr·∫£i nghi·ªám) T·ª∑ l·ªá ng∆∞·ªùi d√πng th·∫≠t b·ªã t·ª´ ch·ªëi (nh·∫≠n nh·∫ßm l√† gi·∫£). C√†ng th·∫•p c√†ng t·ªët. |
| ACER | 15.76% | (L·ªói Trung b√¨nh) Th∆∞·ªõc ƒëo c√¢n b·∫±ng gi·ªØa APCER v√† BPCER, th·ªÉ hi·ªán hi·ªáu su·∫•t t·ªïng th·ªÉ. |
![alt text](results/charts/6_confusion_matrix_heatmap.png)
Ph√¢n t√≠ch: K·∫øt qu·∫£ cho th·∫•y m√¥ h√¨nh c√≥ kh·∫£ nƒÉng ph√°t hi·ªán t·∫•n c√¥ng gi·∫£ m·∫°o t·ªët (AP√¥n m·∫∑t ph·ª©c t·∫°p, s·ª≠ d·ª•ng ki·∫øn tr√∫c ViT v√† Cross-Attention hi·ªán ƒë·∫°i.
C√°c h∆∞·ªõng c·∫£i thi·ªán trong t∆∞∆°ng lai:
C·∫£i thi·ªán BPCER: Hu·∫•n luy·ªán DFG tr√™n m·ªôt t·∫≠p d·ªØ li·ªáu th·∫≠t ƒëa d·∫°ng h∆°n ƒë·ªÉ gi·∫£m t·ª∑ l·ªá nh·∫≠n di·ªán nh·∫ßm ng∆∞·ªùi d√πng th·∫≠t.
ƒê√°nh gi√° Ch√©o Mi·ªÅn (Cross-Domain): Ki·ªÉm tra m√¥ h√¨nh tr√™n c√°c b·ªô d·ªØ li·ªáu ho√†n to√†n kh√°c (v√≠ d·ª•: OULU-NPU) ƒë·ªÉ ƒë√°nh gi√° kh·∫£ nƒÉng t·ªïng qu√°t h√≥a.
T·ªëi ∆∞u h√≥a choCER th·∫•p). Tuy nhi√™n, ƒëi·ªÉm y·∫øu n·∫±m ·ªü t·ª∑ l·ªá nh·∫≠n nh·∫ßm ng∆∞·ªùi d√πng th·∫≠t (BPCER cao), ch·ªß Tri·ªÉn khai Th·ª±c t·∫ø: √Åp d·ª•ng k·ªπ thu·∫≠t Ch∆∞ng c·∫•t M√¥ h√¨nh (Model Distillation) ƒë·ªÉ t·∫°o ra m·ªôt m√¥ h√¨nh "h·ªçc tr√≤" g·ªçn nh·∫π, c√≥ kh·∫£ nƒÉng tri·ªÉn khai th·ªùi gian th·ª±c.
